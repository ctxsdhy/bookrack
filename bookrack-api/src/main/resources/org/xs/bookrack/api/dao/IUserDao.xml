<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.xs.bookrack.api.dao.IUserDao">
	
	<!-- 字段 -->
	<sql id="columnList">
		id, nick_name, email, phone, password, weixin_id, weixin_name, weibo_id, weibo_name, 
		github_id, github_name, douban_id, douban_name, user_img_url, user_name, job_num, 
		profile, create_time, role
	</sql>
	
	<!-- 获取单条数据 -->
	<select id="get" resultType="org.xs.bookrack.api.entity.UserInfo">
		SELECT <include refid="columnList" />
		FROM bookrack_user
		<where>1=1
			<if test="id != null and id != ''">AND id = #{id}</if>
		</where>
	</select>
	
	<!-- 查询数据列表 -->
	<select id="findList" resultType="org.xs.bookrack.api.entity.UserInfo">
		SELECT <include refid="columnList" />
		FROM bookrack_user
		<where>1=1
		</where>
	</select>
	
	<!-- 插入数据 -->
	<insert id="add">
		INSERT INTO bookrack_user
			(id, nick_name, email, phone, password, weixin_id, weixin_name, weibo_id, weibo_name, 
			github_id, github_name, douban_id, douban_name, user_img_url, user_name, job_num, 
			profile, create_time, role)
		VALUES
			(#{id}, #{nickName}, #{email}, #{phone}, #{password}, #{weixinId}, #{weixinName}, #{weiboId}, #{weiboName}, 
			#{githubId}, #{githubName}, #{doubanId}, #{doubanName}, #{userImgUrl}, #{userName}, #{jobNum}, 
			#{profile}, now(), #{role})
	</insert>
	
	<!-- 更新数据 -->
	<update id="update">
		UPDATE bookrack_user
		<set>
			<if test="nick_name != null and nick_name != ''">nick_name = #{nickName}, </if>
			<if test="email != null and email != ''">email = #{email}, </if>
			<if test="phone != null and phone != ''">phone = #{phone}, </if>
			<if test="password != null and password != ''">password = #{password}, </if>
			<if test="weixin_id != null and weixin_id != ''">weixin_id = #{weixinId}, </if>
			<if test="weixin_name != null and weixin_name != ''">weixin_name = #{weixinName}, </if>
			<if test="weibo_id != null and weibo_id != ''">weibo_id = #{weiboId}, </if>
			<if test="weibo_name != null and weibo_name != ''">weibo_name = #{weiboName}, </if>
			<if test="github_id != null and github_id != ''">github_id = #{githubId}, </if>
			<if test="github_name != null and github_name != ''">github_name = #{githubName}, </if>
			<if test="douban_id != null and douban_id != ''">douban_id = #{doubanId}, </if>
			<if test="douban_name != null and douban_name != ''">douban_name = #{doubanName}, </if>
			<if test="user_img_url != null and user_img_url != ''">user_img_url = #{userImgUrl}, </if>
			<if test="user_name != null and user_name != ''">user_name = #{userName}, </if>
			<if test="job_num != null and job_num != ''">job_num = #{jobNum}, </if>
			<if test="profile != null and profile != ''">profile = #{profile}, </if>
			<if test="role != null and role != ''">role = #{role}, </if>
		</set>
		WHERE id = #{id}
	</update>
	
	<!-- 删除数据 -->
	<delete id="delete">
		DELETE FROM bookrack_user
		WHERE id = #{id}
	</delete>
</mapper>